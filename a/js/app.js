const registrationModal=document.getElementById("registrationModal"),modalOverlay=document.getElementById("modalOverlay"),openModalBtn=document.getElementById("openModalBtn"),openModalBtnMd=document.getElementById("openModalBtnMd"),closeModalBtn=document.getElementById("closeModalBtn"),registrationForm=document.getElementById("registrationForm"),phoneInput=document.getElementById("phone"),phoneError=document.getElementById("phoneError"),submitBtn=document.getElementById("submitBtn"),submitBtnText=document.getElementById("submitBtnText"),homePage=document.getElementById("homePage"),subscribePage=document.getElementById("subscribePage");let isSubmitting=!1;function openModal(){registrationModal&&(registrationModal.style.display="flex")}function closeModal(){registrationModal&&(registrationModal.style.display="none")}function formatPhoneNumber(e){const t=e.replace(/[^\d+]/g,"");if(t.startsWith("+998")){const e=t.slice(4);return e.length<=2?`+998 ${e}`:e.length<=5?`+998 ${e.slice(0,2)}-${e.slice(2)}`:e.length<=7?`+998 ${e.slice(0,2)}-${e.slice(2,5)}-${e.slice(5)}`:`+998 ${e.slice(0,2)}-${e.slice(2,5)}-${e.slice(5,7)}-${e.slice(7,9)}`}return t}function validatePhoneNumber(e){return/^\+998 \d{2}-\d{3}-\d{2}-\d{2}$/.test(e)}function handleSubmit(e){if(e.preventDefault(),isSubmitting)return;if(!validatePhoneNumber(phoneInput.value))return void(phoneError.style.display="block");phoneError.style.display="none",isSubmitting=!0,submitBtn.disabled=!0;const t=new Date,n=t.toLocaleDateString("uz-UZ"),o=t.toLocaleTimeString("uz-UZ"),a={phone:phoneInput.value,dateTime:`${n} - ${o}`};localStorage.setItem("registrationData",JSON.stringify(a)),window.location.href="/thankYou.html"}function showSubscribePage(){homePage&&subscribePage&&(homePage.style.display="none",subscribePage.style.display="block")}function sendStoredData(){const e=localStorage.getItem("registrationData");if(e){const{phone:t,dateTime:n}=JSON.parse(e),o=new FormData;o.append("Telefon raqam",t),o.append("Royhatdan o'tgan vaqti",n),fetch("https://script.google.com/macros/s/AKfycbyvvuFVqfgy2mD1zyi2FBALAW7bg2AFXC8vQzZ8CxvcjiNxNSquAgGDnMIWdKl-OKQ5/exec",{method:"POST",body:o}).then((e=>{if(!e.ok)throw new Error("Network response was not ok");return e.json()})).then((e=>{console.log("Success:",e),phoneInput&&(phoneInput.value="+998"),localStorage.removeItem("registrationData")})).catch((e=>{console.error("Error submitting form:",e)})).finally((()=>{isSubmitting=!1,submitBtnText&&submitBtn&&(submitBtnText.innerText="Royhatdan o'tish",submitBtn.disabled=!1)}))}}document.addEventListener("DOMContentLoaded",(function(){const e=document.createElement("link");e.rel="preconnect",e.href="https://fonts.gstatic.com",document.head.appendChild(e),openModalBtn&&openModalBtn.addEventListener("click",openModal),openModalBtnMd&&openModalBtnMd.addEventListener("click",openModal),closeModalBtn&&closeModalBtn.addEventListener("click",closeModal),modalOverlay&&modalOverlay.addEventListener("click",closeModal),phoneInput&&phoneInput.addEventListener("input",(function(e){const t=formatPhoneNumber(e.target.value);phoneInput.value=t,phoneError.style.display="none"})),registrationForm&&registrationForm.addEventListener("submit",handleSubmit),window.location.pathname.includes("thankYou.html")&&sendStoredData()})),openModalBtn&&(openModalBtn.onclick=openModal),openModalBtnMd&&(openModalBtnMd.onclick=openModal);